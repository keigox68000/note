---
title: "Google Apps Scriptで、note記事とYouTube動画を宣伝している話"
date: "2020-07-28"
---

　自分のTwitterプロフィールを見ると、Twitterを使い始めたのが2007年6月らしい。もう14年目になるわけだ。掲示板やメール、場合によってはニュースグループ等に端を発するインターネット上で情報交換、コミュニケーションを行うツールとしては、あきれるぐらい長い間使っていると言えるだろう。

　長い間Twitterを使っているせいか、フォロー／フォロワーも増えてきて、せっかくだから、YouTubeやnoteに投稿している動画や記事をTwitter上で宣伝しようと思い立った。これまでに投稿した動画や記事のURLを、ランダムにツイートしようというわけだ。

　最初は無料のTwitter botサービスを利用してツイートしてみた。動画や記事のURLを登録しなければならない面倒さはあるものの、お手軽に宣伝ツイートが実現できた。しかし、すぐにこの方法は頓挫する。YouTubeに投稿した動画が数千件（！）を超えていて、無料サービスでは登録しきれないということが判明したのだ。

　もちろん自分のアップロードした動画すべてを登録する必要はないのだが、今さら数千件の動画を確認して、宣伝するものとしないものを選別するのも現実的な方法ではない。ちなみに、YouTube動画のURLは、自分のチャンネルページのHTMLから半自動で生成した。そこから選択するのは無理である。昨年末から書き始めたnoteの記事だって、なんだかんだですでに200件を超えている。とても選別していられない。

　そこで、自分でプログラムを書くことを考えた。その昔、phpでTwitter botを自作したことがある。なんとかならないことはないだろう。問題は、そのスクリプトを動かすサーバの手配とか、今のTwitterAPIの仕様とか調べなければならいことだ。昔のTwitter botは、自宅のMacを24時間稼働させて、そこでphpを動かしてツイートしていたのだが、正直しょうもないことに無駄な電気を使いすぎた感はある。できれば、クラウド上で動くスクリプトにしたい。

　いろいろ探していると、Google Apps Scriptがサーバいらずで、しかもスプレッドシート等と連携して使えるということがわかった。Googleアカウントさえあれば、無料で使えるクラウド上で動作するスクリプトだ。特に、僕の大好きなスプレッドシートと連携できるのが気に入った。何しろ、オークションのやり取りから、アーケード基板のROM用バイナリまで、すべてエクセルを使っていたような人間なので、スプレッドシート大歓迎なのである。

 Google Apps Scriptは、JavaScriptがベースとなった文法で書けるため、比較的平易で、JavaScriptなんて全然忘れちまったい、という僕にもすぐに書けそうである。が、しかし、そんなことを思い出すまでもなく、ネット上にGoogle Apps Scriptを使ってツイートするようなスクリプトがたくさん置いてあった。先人の知恵は大いに利用させていただこう。

[https://qiita.com/yoshi\_yast/items/c2d04588f39c5187e75c](https://qiita.com/yoshi_yast/items/c2d04588f39c5187e75c)

[https://moripro.net/gas-twitter-bot/](https://moripro.net/gas-twitter-bot/)

[https://tonari-it.com/gas-timed-driven-trigger/#toc5](https://tonari-it.com/gas-timed-driven-trigger/#toc5)

　かくして、Googleスプレッドシートに、botで紹介したい文章をダラダラと記述すれば、その中からランダムに1項目を選択してツイートするスクリプトができあがった。ネット上をふらふらと調べて回った時間も含めて1時間強で完成した。実に簡単である。

　そんなわけで、僕のTwitterアカウントは今日もYouTube動画とnote記事の宣伝をツイートしている。あまりうるさくならないように、1日3回程度にしておいた。でも、これによって古い記事にも注目してもらえたり、動画も見てもらえたりするので、ちょっと嬉しい。今後もよろしくお願いします。

[https://twitter.com/keigox68000](https://twitter.com/keigox68000)
